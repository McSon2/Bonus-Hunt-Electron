<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="" />
    <meta name="author" content="" />

    <title>Bonus Hunt</title>

    <!-- Custom fonts for this template-->
    <link
      href="../vendor/fontawesome-free/css/all.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
      rel="stylesheet"
    />
    <link
      href="../vendor/datatables/dataTables.bootstrap4.min.css"
      rel="stylesheet"
    />
    <link
      href="../vendor/select2/select2.min.css"
      rel="stylesheet"
    />

    <!-- Custom styles for this template-->
    <link href="../css/sb-admin-2.min.css" rel="stylesheet" />
    <link href="../css/custom.css" rel="stylesheet" />
  </head>

  <body id="page-top">
    <!-- Page Wrapper -->
    <div id="wrapper">
      <!-- Sidebar -->
      <ul
        class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion fixed-top"
        id="accordionSidebar"
      >
        <!-- Sidebar - Brand -->
        <a
          class="sidebar-brand d-flex align-items-center justify-content-center"
          href="../index.html"
        >
          <div class="logo">
            <img src="../images/bonus.png" height="40px" />
          </div>
          <div class="sidebar-brand-text mx-3">Bonus Hunt</div>
        </a>

        <!-- Divider -->
        <hr class="sidebar-divider my-0" />

        <!-- Nav Item - Dashboard -->
        <li class="nav-item active">
          <a class="nav-link" href="../index.html">
            <i class="nav-icon fas fa-home"></i>
            <span>Dashboard</span></a
          >
          <a class="nav-link" href="bonus-hunt.html">
            <i class="nav-icon fas fa-bullseye"></i>
            <span>Bonus Hunt</span></a
          >

          <a class="nav-link" href="slot.html">
            <i class="nav-icon fas fa-bullseye"></i>
            <span>Slots</span></a
          >
          
        </li>

        <!-- Divider 
            <hr class="sidebar-divider">
            -->

        <!-- Heading 
            <div class="sidebar-heading">
                Interface
            </div>
            -->

        <!--
          <li class="nav-item">
            <a class="nav-link" href="HTML/bonushunt.html">
              <i class="nav-icon fas fa-bullseye"></i>
              <span>Bonus Hunts</span></a
            >
          </li>

          <li class="nav-item">
            <a class="nav-link" href="HTML/tournaments.html">
              <i class="nav-icon fas fa-chess"></i>
              <span>Tournaments</span></a
            >
          </li>

          <li class="nav-item">
            <a class="nav-link" href="HTML/widgets.html">
              <i class="nav-icon fas fa-th"></i>
              <span> Streaming Widgets </span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="HTML/setwidgets.html">
              <i class="nav-icon fas fa-cog"></i>
              <span> Widgets Settings </span>
            </a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="HTML/stats.html">
              <i class="nav-icon fas fa-chart-line"></i>
              <span> Statistics </span>
            </a>
          </li>

          Nav Item - Pages Collapse Menu 
              <li class="nav-item">
                  <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwo"
                      aria-expanded="true" aria-controls="collapseTwo">
                      <i class="fas fa-fw fa-cog"></i>
                      <span>Components</span>
                  </a>
                  <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar">
                      <div class="bg-white py-2 collapse-inner rounded">
                          <h6 class="collapse-header">Custom Components:</h6>
                          <a class="collapse-item" href="buttons.html">Buttons</a>
                          <a class="collapse-item" href="cards.html">Cards</a>
                      </div>
                  </div>
              </li>

        -->

        <!-- Divider -->
        <hr class="sidebar-divider" />

        <!-- Sidebar Toggler (Sidebar) -->
      </ul>
      <!-- End of Sidebar -->

      <!-- Content Wrapper -->
      <div id="content-wrapper" class="d-flex flex-column">
        <!-- Main Content -->
        <div id="content">
          <!-- Topbar -->
          <nav
            id="topMenu"
            class="navbar navbar-expand navbar-dark bg-light topbar static-top shadow-5-strong fixed-top"
          >
            <!-- Sidebar Toggle (Topbar) -->
            <button
              id="sidebarToggleTop"
              class="btn btn-link d-md-none rounded-circle mr-3"
            >
              <i class="fa fa-bars"></i>
            </button>
            <!-- Title Bar -->
            <u class="nav" id="topMenuBtns">
              <li>
                <button id="reduceBtn" class="topMenuBtn">&minus;</button>
              </li>
              <li>
                <button id="sizeBtn" class="topMenuBtn">
                  &#128470;&#xFE0E;
                </button>
              </li>
              <li>
                <button id="closeBtn" class="topMenuBtn">
                  &#128473;&#xFE0E;
                </button>
              </li>
            </u>
          </nav>
          <!-- End of Topbar -->

          <!-- Begin Page Content -->
          <div
            class="container-fluid justify-content-center col-sm-12"
            id="BOD"
          >
            <!-- Page Heading -->

            <div
              class="d-sm-flex align-items-center justify-content-between mb-4"
            >
              <h1 class="h3 mb-0 text-gray-800" id="titrepage">Slots</h1>
            </div>

            <!-- End Page Heading -->

           

            <!-- Modal Ajout hunt -->

            <div
              class="modal fade show"
              id="PlusHunt"
              aria-labelledby="titlemodaladdhunt"
              aria-modal="true"
            >
              <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="titlemodaladdhunt">
                      Create Slot
                    </h5>
                    <button
                      type="button"
                      class="close"
                      data-dismiss="modal"
                      aria-label="Close"
                    >
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div class="form-group">
                      <label>Slot</label>
                      <input
                      class="form-control"
                      type="text"
                      id="createslot"
                      name="createslot"
                      />
                    </div>
                    <div class="form-group">
                        <label>Choose Provider</label>
                        <select
                            name="providers"
                            class="form-control select2 select2-hidden-accessible"
                            style="width: 100%"
                            id="select2">
                            <option selected="selected" id="select"></option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="betsize">RTP</label>
                        <input
                        class="form-control"
                        type="text"
                        id="creatertp"
                        name="creatertp"
                        />
                      </div>
                      <div class="form-group">
                        <label for="betsize">Volatility</label>
                        <input
                        class="form-control"
                        type="text"
                        id="createvolatility"
                        name="createvolatility"
                        />
                      </div>
                      <div class="form-group">
                        <label for="betsize">Potential</label>
                        <input
                        class="form-control"
                        type="text"
                        id="createpotential"
                        name="createpotential"
                        />
                      </div>
                  </div>
                  <div class="modal-footer justify-content-between">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-dismiss="modal"
                    >
                      Close
                    </button>
                    <button
                      type="submit"
                      class="btn btn-primary"
                      data-dismiss="modal"
                      id="SaveHunt"
                    >
                      Save
                    </button>
                  </div>
                </div>
              </div>
            </div>

            

            <!-- Modal Modif hunt -->

            <div
              class="modal fade show"
              id="UpdateBonus"
              aria-labelledby="titlemodaladdhunt"
              aria-modal="true"
            >
              <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="titlemodaladdhunt">
                      Update Slot
                    </h5>
                    <button
                      type="button"
                      class="close"
                      data-dismiss="modal"
                      aria-label="Close"
                    >
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div class="form-group">
                      <label for="NameHunt">Slot</label>
                      <input
                        class="form-control"
                        type="text"
                        id="slotname"
                        name="slotname"
                      />
                    </div>
                    <div class="form-group">
                      <label for="StartHunt">Provider</label>
                      <input
                        class="form-control"
                        type="text"
                        id="provider"
                        name="provider"
                      />
                    </div>
                    <div class="form-group">
                      <label for="StartHunt">RTP</label>
                      <input
                      class="form-control"
                      type="text"
                      id="rtp"
                      name="rtp"
                      />
                    </div>
                    <div class="form-group">
                        <label for="StartHunt">Volatility</label>
                        <input
                        class="form-control"
                        type="text"
                        id="volatility"
                        name="volatility"
                        />
                    </div>
                    <div class="form-group">
                        <label for="StartHunt">Potential</label>
                        <input
                        class="form-control"
                        type="text"
                        id="potential"
                        name="potential"
                        />
                    </div>
                  </div>
                  <div class="modal-footer justify-content-between">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-dismiss="modal"
                    >
                      Close
                    </button>
                    <button
                      type="submit"
                      class="btn btn-primary"
                      data-dismiss="modal"
                      id="updatebonus"
                    >
                      Save
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Table -->

            <div class="row">
              <div class="col-md-12">
                <div class="card">
                  <div class="card-header">
                    <h3 class="card-title float-left">Slots</h3>
                    <button
                      type="button"
                      class="btn btn-success float-right"
                      data-toggle="modal"
                      data-target="#PlusHunt"
                      id="plushunt"
                    >
                      <i class="fas fa-plus-circle"></i>
                    </button>
                  </div>
                  <div class="card-body p-0">
                    <table
                      class="table table-striped table-hover"
                      id="tableBonushunt"
                    >
                      <thead class="thead-light">
                        <tr>
                          <th scope="col">Slots</th>
                          <th scope="col">Provider</th>
                          <th scope="col">RTP</th>
                          <th scope="col">Volatility</th>
                          <th scope="col">Potential</th>
                          <th
                            scope="col"
                            style="width: 180px"
                            class="text-center"
                          >
                            Actions
                          </th>
                        </tr>
                      </thead>
                      <tbody></tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <!-- End Table -->
          </div>
          <!-- End Page Content -->
        </div>

        <!-- End Main Content -->

        <!-- Footer -->
        <footer class="sticky-footer bg-white">
          <div class="container my-auto">
            <div class="copyright text-center my-auto">
              <span></span>
            </div>
          </div>
        </footer>
        <!-- End of Footer -->
      </div>
      <!-- End of Content Wrapper -->
    </div>
    <!-- End of Page Wrapper -->

    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
      <i class="fas fa-angle-up"></i>
    </a>

    <!-- Bootstrap core JavaScript-->
    <script src="../vendor/jquery/jquery.min.js"></script>
    <script src="../vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="../vendor/jquery-easing/jquery.easing.min.js"></script>
    <script src="../vendor/datatables/jquery.dataTables.min.js"></script>
    <script src="../vendor/datatables/dataTables.bootstrap4.min.js"></script>
    <script src="../vendor/select2/select2.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="../js/sb-admin-2.min.js"></script>
    <script src="../js/titlebar.js"></script>
    <script src="../js/renderer.js"></script>

    <!--SCRIPT SQL-->

    <script>
      
    //Select2
        document.addEventListener("DOMContentLoaded", async () => {
            var provider = window.api.provider()
            var providers = $.map(provider, function (obj) {
                obj.text = obj.text || obj.provider;
                return obj
            })
            $(".select2").select2({
                data: providers
            })   
        
        })


      //ajout d'un hunt
      const SaveHunt = document.getElementById("SaveHunt");
      
      SaveHunt.addEventListener("click", () => {
        
        let select = document.getElementById("select2")
        let id = select.value
        let pro = window.api.providerbyid(id)
        let prov = pro.map((elem) => {
          var num = elem.provider
          return num
        })
        let provider = String(prov)
        const slot = document.getElementById("createslot").value
        const rtp = document.getElementById("creatertp").value
        const volatility = document.getElementById("createvolatility").value
        const potential = document.getElementById("createpotential").value
        
        window.api.newslot(slot,provider,rtp,volatility,potential);
        app.window.reload();
      });




      

      //bonus hunt table
      document.addEventListener("DOMContentLoaded", async () => {
        
        let bonushunt = window.api.allslot();

        var tableBonushuntbody = document
          .getElementById("tableBonushunt")
          .getElementsByTagName("tbody")[0];
        var tableBonushunt = document.getElementById("tableBonushunt");
        var tableRows = tableBonushunt.querySelectorAll("thead > tr");

        tableRows.forEach((el, i) => {
          if (i > 0) el.parentNode.removeChild(el);
        });

        
        bonushunt.forEach((el) => {
          var row = tableBonushuntbody.insertRow(0);
          
          
          var cell1 = row.insertCell(0);
          var cell2 = row.insertCell(1);
          var cell3 = row.insertCell(2);
          var cell4 = row.insertCell(3);
          var cell5 = row.insertCell(4);
          var cell6 = row.insertCell(5);

          row.setAttribute("scope", "row");
          cell6.setAttribute("class", "text-center");
          cell1.setAttribute("text-transform", "lowercase");

          cell1.innerHTML = el.slot;
          cell2.innerHTML = el.provider;
          cell3.innerHTML = el.rtp;
          cell4.innerHTML = el.volatility;
          cell5.innerHTML = el.potential;
          cell6.innerHTML =
          '<div class="btn-group">\
            <button type="button"\
              class="btn btn-info toggleEditModal"\
              data-toggle="modal"\
              data-target="#UpdateBonus"\
              data-title="' + el.slot +'"\
              data-start="' + el.bet_size +'"\
              data-payout="' + el.payout +'"\
              data-id="'+ el.id +'"\
              id="id:'+ el.id +'"\
              >\
              <i class="fas fa-pen"></i>\
            </button>\
          </div>'
          
          

          // update bonus
          var test = "id:"+el.id
          var updateyes = document.getElementById("updatebonus");
          var btnupdate = document.getElementById(test);
          var slotname = document.getElementById("slotname");
          var pro = document.getElementById("provider");
          var rtps = document.getElementById("rtp");
          var volatilitys = document.getElementById("volatility");
          var potentials = document.getElementById("potential");

          btnupdate.addEventListener('click', () => {
            
            slotname.setAttribute('value',el.slot);
            pro.setAttribute('value',el.provider);
            rtps.setAttribute('value',el.rtp);
            volatilitys.setAttribute('value',el.volatility);
            potentials.setAttribute('value',el.potential);
            var id = el.id
            
            updateyes.addEventListener('click', () => {
              const slot = slotname.value
              const provider = pro.value;
              const rtp = rtps.value
              const volatility = volatilitys.value;
              const potential = potentials.value;
              window.api.updateslot(id,slot,provider,rtp,volatility,potential);
              app.window.reload();
            })
          })

        });
        $("#tableBonushunt").DataTable();
      });

    </script>
  </body>
</html>
